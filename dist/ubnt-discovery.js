(()=>{var e={721:(e,r,o)=>{const a=o(891),{Buffer:t}=o(254),s=o(555),n=a.createSocket("udp4"),d=t.from("01000000","hex"),i=[];n.on("error",(e=>{console.error(`server error:\n${e.stack}`),n.close()})),n.on("message",((e,r)=>{const o={ip:"",mac:"",firmware:"",firmwareVersion:"",name:"",modelShort:"",modelFull:"",essid:"",mode:""};if("010000"!=e.toString("hex",0,3))return void console.log("INVALID signature");o.ip=r.address;let a=4;for(;e.byteLength-a>0;){const r=e.toString("hex",a,a+1);a+=2;const s=e.readInt8(a);a+=1;const n=e.toString("hex",a,a+s);switch(r){case"01":o.mac=n.toUpperCase().match(/.{1,2}/g).join(":");break;case"03":o.firmware=t.from(n,"hex").toString(),o.firmwareVersion=o.firmware.match(/v(\d+\.\d+\.\d+)/g)[0].slice(1);break;case"0b":o.name=t.from(n,"hex").toString();break;case"0c":o.modelShort=t.from(n,"hex").toString();break;case"14":o.modelFull=t.from(n,"hex").toString();break;case"0d":o.essid=t.from(n,"hex").toString();break;case"0e":switch(e.readInt8(a)){case 0:o.mode="auto";break;case 1:o.mode="adhoc";break;case 2:o.mode="sta";break;case 3:o.mode="ap";break;case 4:o.mode="repeater";break;case 5:o.mode="secondary";break;case 6:o.mode="monitor"}}a+=s}0==i.filter((e=>e.ip==o.ip)).length&&i.push(o)})),e.exports={getDevices:(e=1e3)=>new Promise(((r,o)=>{n.bind((()=>{n.setBroadcast(!0),i.length=0,n.send(d,0,4,10001,"255.255.255.255",(function(e,r){e&&o(e)})),setTimeout((()=>{n.close(),i.sort(s.sortByIp),r(i)}),e)}))}))}},555:e=>{e.exports={sortByIp:function(e,r){return Number(e.ip.split(".").map((e=>`000${e}`.slice(-3))).join(""))-Number(r.ip.split(".").map((e=>`000${e}`.slice(-3))).join(""))}}},891:e=>{"use strict";e.exports=require("dgram")},254:e=>{"use strict";e.exports=require("node:buffer")}},r={};(function o(a){var t=r[a];if(void 0!==t)return t.exports;var s=r[a]={exports:{}};return e[a](s,s.exports,o),s.exports})(721).getDevices().then((e=>{console.log("IP".padEnd(15),"MAC".padEnd(19),"NAME".padEnd(23),"MODE".padEnd(6),"MODEL".padEnd(22),"SSID".padEnd(20),"FIRMWARE".padEnd(10),"\n"),e.forEach((e=>{console.log(e.ip.toString().padEnd(15),e.mac.padEnd(19),e.name.padEnd(23),e.mode.toUpperCase().padEnd(6),e.modelFull?e.modelFull.padEnd(22):e.modelShort.padEnd(22),e.essid.padEnd(20),e.firmwareVersion.padEnd(10))})),console.log("Total devices:",e.length)})).catch((e=>{console.warn(e)}))})();